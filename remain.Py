import telebot
import time
from threading import Thread

# ุงูุชููู ุจุชุงุนู
TOKEN = '8445157524:AAF8oTwxP9MLk6hf4h5YzghwvREjCreSuy4'
bot = telebot.TeleBot(TOKEN)

# ุงูุฅุนุฏุงุฏุงุช
chats = set()
is_running = True  # ูุชุบูุฑ ููุชุญูู ูู ุงูุฅููุงู ูุงูุชุดุบูู

@bot.message_handler(commands=['start'])
def start(message):
    global is_running
    is_running = True
    chats.add(message.chat.id)
    bot.reply_to(message, "โ ุชู ุงูุชูุนูู! ูููุฑูู ุจุงูุตูุงุฉ ุนูู ุงููุจู ูู 3 ุฏูุงุฆู ๏ทบ. ูู ุนุงูุฒ ุชููู ุงุจุนุช /stop")

@bot.message_handler(commands=['stop'])
def stop(message):
    global is_running
    is_running = False
    bot.reply_to(message, "๐ ุชู ุฅููุงู ุงูุชุฐููุฑ. ุงุจุนุช /start ุนุดุงู ุชุดุบูู ุชุงูู.")

def remind_logic():
    while True:
        if is_running and len(chats) > 0:
            for chat_id in list(chats):
                try:
                    bot.send_message(chat_id, "ุตูู ุนูู ุงููุจู ๏ทบ ูุด ุดุฑุท ุชูุชุจ ุตูู ู ุณุฑู")
                except:
                    pass
            time.sleep(180) # ุงูุงูุชุธุงุฑ 3 ุฏูุงุฆู (180 ุซุงููุฉ)
        else:
            time.sleep(5) # ูู ูุงูู ูุดูู ูู 5 ุซูุงูู ุนุดุงู ููููุฌุด

# ุชุดุบูู ุงูุชุฐููุฑ ูู ุงูุฎูููุฉ
Thread(target=remind_logic, daemon=True).start()

print("ุงูุจูุช ุดุบุงู...")
bot.infinity_polling()
